<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles/style.css">    
</head>

<body>
    <h1>Trip Mapper</h1>
    <div class="grid-container">
        <div class="grid-item">
            <div class="editable-textbox" contenteditable="true" id="textTarget" onfocusout="saveSelection(this)">Enter some <strong>good </strong>text here
            </div>
            <textarea rows="12" cols="50" id = "textSample"></textarea>
        </div>
        <div class="grid-item">
            <div id="googleMap1" style="width:100%;height:400px;"></div>
        </div>
    </div>



    <script>
        function myMap() {
            //Map target, zoom and center required            
            var mapCanvas = document.getElementById('googleMap1');
            var textTarget = document.getElementById('textTarget');
            var mapCenter = { lat: 47.4829, lng: -122.2171 };
            var mapZoom = 4;
            var mapOptions = { center: mapCenter, zoom: mapZoom };
            var map = new google.maps.Map(mapCanvas, mapOptions);
            var firstPoint = new google.maps.LatLng(47.072174, -123.3334);
            var secondPoint = new google.maps.LatLng(24.545756,-81.812441);

            CreateMarker(map, mapCenter);
            CreateLine(map);
            CreateLine2(map);

            google.maps.event.addListener(map, 'click', function (event) {
                //CreateMarker(map, event.latLng);
                AddTextSection(map, event.latLng);

            })


        }
        function CreateLine(map) {
            var firstPoint = new google.maps.LatLng(48.072174, -123.3334);
            var secondPoint = new google.maps.LatLng(24.545756,-81.812441);
            var myLine = [firstPoint, secondPoint];
            var walkPath = new google.maps.Polyline({
                path: [firstPoint, secondPoint],
                strokeColor: "#00ff00",
                strokeOpacity: 0.8,
                strokeWeight: 8
            });
            walkPath.setMap(map);
        }
        function CreateLine2(map) {
            var firstPoint = new google.maps.LatLng(48.072174, -123.3334);
            var secondPoint = new google.maps.LatLng(24.545756,-81.812441);
            var myLine = [firstPoint, secondPoint];

            var walkPath = new google.maps.Polyline({
                path: [firstPoint, secondPoint],
                strokeColor: "#ff0000",
                strokeOpacity: 1,
                strokeWeight: 4,
                zIndex: 500
            });
            walkPath.setMap(map);
        }


        function CreateMarker(map, mapCenter) {
            var marker = new google.maps.Marker({
                position: mapCenter,
                icon: {
                    url: "mapfiles/smileyFace1.png",
                    scaledSize: new google.maps.Size(50, 50),
                },
                animation: google.maps.Animation.BOUNCE,
                title: 'Click to Zoom'

            })
            marker.setMap(map);

            //Pan to last marker on drag
            // map.addListener('center_changed', function () {
            //     window.setTimeout(function () {
            //         map.panTo(marker.getPosition());
            //     }, 1000);
            // });
            marker.addListener('click', function () {
                map.setZoom(12);
                window.setTimeout(function () {
                    map.setZoom(8);
                    },3000);
                map.setCenter(marker.getPosition());
            });
        }
        function AddTextSection(map, latLng) {

             textTarget.innerHTML = textTarget.innerHTML.substring(0,textTarget.selectionStart) + 
                                 latLng.lat().toFixed(5) + textTarget.innerHTML.substring(textTarget.selectionEnd,textTarget.length-1);

        }

    </script>
    <script src="scripts/text.js"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDolGuNslClF0NwUTIS4HPRCwLeJJBz6OI&callback=myMap"
        type="text/javascript"></script>
</body>

</html>